"use strict";(self.webpackChunkmailchimp=self.webpackChunkmailchimp||[]).push([["14890"],{435819:function(e,t,i){i.d(t,{Z:()=>et});var a=Object.defineProperty,n=Object.defineProperties,r=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,c=(e,t,i)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,d=(e,t)=>{for(var i in t||(t={}))s.call(t,i)&&c(e,i,t[i]);if(o)for(var i of o(t))l.call(t,i)&&c(e,i,t[i]);return e},p=(e,t)=>n(e,r(t)),u=(e,t,i)=>new Promise((a,n)=>{var r=e=>{try{s(i.next(e))}catch(e){n(e)}},o=e=>{try{s(i.throw(e))}catch(e){n(e)}},s=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,o);s((i=i.apply(e,t)).next())});let b={hasInitialized:!1,Log:()=>{}},f="MC_LOGGER_QUEUE_IS_FULL",y={hasInitialized:!1,mainQueue:[],waitQueue:[],isBatchServiceActive:!1,isProcessingMainQueue:!1,configurablePropeties:{time:6e3,maxQueueSize:440},batchServiceState:{isPageNavigationOccuring:!1,mainQueuePayloadSize:0}},v=e=>e.reduce((e,t)=>(e[t.keyIndex]=d({},t),delete e[t.keyIndex].keyIndex,e),{});function g(){if(y.isProcessingMainQueue=!0,0===y.mainQueue.length){y.isProcessingMainQueue=!1;return}b.Log({message:"ECS Batch Logs",data:v(y.mainQueue.slice())});let{newMainQueue:e,queuePayloadSize:t}=y.waitQueue.reduce((e,t)=>(e.newMainQueue.push(t.log),e.queuePayloadSize+=t.payLoadSize,e),{newMainQueue:[],queuePayloadSize:0});y.mainQueue=e,y.batchServiceState.mainQueuePayloadSize=t,y.isProcessingMainQueue=!1,y.waitQueue=[]}let h=()=>{!y.isBatchServiceActive&&b.hasInitialized&&(y.isBatchServiceActive=!0,window.addEventListener("beforeunload",()=>{y.batchServiceState.isPageNavigationOccuring=!0,g()}),window.addEventListener(f,()=>{y.batchServiceState.isPageNavigationOccuring||g()}),setInterval(()=>{y.batchServiceState.isPageNavigationOccuring||y.isProcessingMainQueue||g()},y.configurablePropeties.time))},_=e=>{if(y.batchServiceState.isPageNavigationOccuring&&b.hasInitialized){b.Log({message:"ECS Batch Logs",data:v(y.mainQueue.slice())});return}if(void 0===e.keyIndex)throw Error("Invalid log configuration: no keyIndex");let t=JSON.stringify(e.data).length;if(y.isProcessingMainQueue)y.waitQueue.push({log:e,payLoadSize:t});else{let i;(i=!1,y.batchServiceState.mainQueuePayloadSize+t>=y.configurablePropeties.maxQueueSize&&(i=!0),i)?(window.dispatchEvent(new Event(f)),y.waitQueue.push({log:e,payLoadSize:t})):(y.mainQueue.push(e),y.batchServiceState.mainQueuePayloadSize+=t)}};function m(e){e.data=p(d({},e.data),{isError:!1,log_timestamp:new Date}),_(e)}function w(e){let t={isError:!0,log_timestamp:new Date};e.data=d(d({},e.data),t),b.Log(e)}let E=e=>{b.Log=e,b.hasInitialized=!0,h()},I=!1,T={init:function(e,t){return u(this,null,function*(){if(I)throw Error("The library is already initialized");yield function(e,t){return u(this,null,function*(){let i=A(!0);if(void 0===i)return;i.load=function(e,t){return u(this,null,function*(){return yield new Promise((a,n)=>{let r=document.createElement("script");r.type="text/javascript",r.async=!0,r.addEventListener("load",function(){a(void 0)},{once:!0}),r.onerror=function(){n(Error("Failed to load script"))},r.src="https://cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";let o=document.getElementsByTagName("script")[0];if(null!=o.parentNode)o.parentNode.insertBefore(r,o);else throw w({message:"The Segment Library has failed the first attempt to load",data:{step:"The library has failed to insert library script tag"}}),Error("Issue with launching script");i._loadOptions=t})})},i._writeKey=`${e}`,i.SNIPPET_VERSION="4.15.3";let a=0,n=!1;try{for(;a<3&&!n;)try{yield i.load(`${e}`,t),n=!0}catch(e){if(a++,3===a)throw Error(e);yield function(e){return u(this,null,function*(){return yield new Promise(e=>setTimeout(e,1e3))})}(0)}yield u(this,null,function*(){return yield new Promise(e=>{i.ready(()=>{e()})})}),I=!0}catch(n){let t=!1;m({message:"The Segment Library has failed the first attempt to load",data:{step:"First attempt to load failed trying to see if adblocker is preventing the library from loading",error:n.message},keyIndex:"load_segment_failed_first"});try{let t=yield fetch("https://cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js"),a=yield t.text(),n=document.getElementsByTagName("script")[0];if(null!=n.parentNode&&""!==a){try{let e=document.createElement("script");e.type="text/javascript",e.innerHTML=a,n.parentNode.insertBefore(e,n)}catch(e){throw w({message:"The Segment Library has failed the first attempt to load",data:{step:"The library has failed to insert library script code"}}),Error("Issue with launching script")}I=!0,yield u(this,null,function*(){return yield new Promise(e=>{i.ready(()=>{e()})})});return}w({message:"The Segment Library has failed the first attempt to load",data:{step:"The library has failed the second attempt to load via the script type text/javascript tag"}})}catch(e){e instanceof TypeError?t=!0:(w({message:"The Segment Library has failed the first attempt to load",data:{step:"The library has failed the second attempt to load",error:e}}),console.error("The Segment Lbrary has failed to load. Attached is one of the error messages",JSON.stringify(e)))}if(window.analytics=void 0,console.error(`The Segment Lbrary has failed to load after retrying ${a} times. Attached is the final error message`,n.message),t)throw Error("Loading the Segment Library has failed due to it's resource request being blocked")}})}(e,t),null!=window.analytics&&(T.Analytics=window.analytics)})},Analytics:{},attachAnalyticsToWindow:A},S=e=>void 0!==e.track;function A(e){let t=T.Analytics=window.analytics=void 0!==window.analytics?window.analytics:[];if(void 0===t.initialize){if(void 0!==e&&e&&t.invoked)return t;if(t.invoked)return;t.invoked=!0,t.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"],t.factory=function(e){return function(){let i=Array.prototype.slice.call(arguments);return i.unshift(e),t.push(i),t}};for(let e=0;e<t.methods.length;e++){let i=t.methods[e];t[i]=t.factory(i)}return t}}let k={abortAppfabricCreationEvent:new AbortController,abortAppfabricInitialziedEvent:new AbortController,abortInstanceDetectionEvent:new AbortController,shouldAbortEverything:!1,shouldAbortAppFabricListeners:!1},L=()=>{k.shouldAbortEverything=!0,k.abortAppfabricCreationEvent.abort(),k.abortAppfabricInitialziedEvent.abort(),k.abortInstanceDetectionEvent.abort()},C=()=>{k.abortAppfabricCreationEvent.abort(),k.abortAppfabricInitialziedEvent.abort()},j=()=>k.abortInstanceDetectionEvent.abort(),P=()=>k.abortAppfabricInitialziedEvent.signal,z=()=>k.abortInstanceDetectionEvent.signal,O="INSTANCE_DETECTION_LISTENER",x="DETECTED_INSTANCE_SHARING_STATE",N=()=>{window.__MC_ECS_LIB||(window.__MC_ECS_LIB={has_lib_init_started:!1,has_appfabric_init_detection_listener_started:!1})},D=({internalState:e,EcsTracking:t,LOGGER_STATE:i,BATCH_LOGS_INTERNAL_STATE:a})=>{window.addEventListener(O,()=>{window.dispatchEvent(new CustomEvent(x,{detail:{internalState:e,EcsTracking:t,LOGGER_STATE:i,BATCH_LOGS_INTERNAL_STATE:a},cancelable:!1}))})},M=({internalState:e,EcsTracking:t,LOGGER_STATE:i,BATCH_LOGS_INTERNAL_STATE:a})=>{window.dispatchEvent(new CustomEvent(x,{detail:{internalState:e,EcsTracking:t,LOGGER_STATE:i,BATCH_LOGS_INTERNAL_STATE:a},cancelable:!1}))},B="appFabricHasInitialized_ecs",F={hasAppFabricInitialized:!!window.appFabricInstance},$=window.__MC_ECS_LIB?window.__MC_ECS_LIB.has_appfabric_init_detection_listener_started:(N(),!1);F.hasAppFabricInitialized||$||(window.__MC_ECS_LIB.has_appfabric_init_detection_listener_started=!0,window.addEventListener("appFabricInstanceCreated",()=>{F.hasAppFabricInitialized=!0,window.dispatchEvent(new Event(B))},{signal:k.abortAppfabricCreationEvent.signal}));let Q=(e,t)=>u(void 0,null,function*(){return t&&console.log("mc_ecs_logs: Window.AppFabric available"),m({message:"ECS Tracking Library: AppFabric Initialize",data:{step:"detectIfAppFabricHasLoaded"},keyIndex:"appfabric_init_if_loaded"}),new Promise((i,a)=>{let n={hasPromiseResolved:!1,hasEventBeenHandled:!1},r=()=>u(void 0,null,function*(){var r,o;if(t&&console.log("mc_ecs_logs: Connecting to Appfabric"),!n.hasEventBeenHandled){n.hasEventBeenHandled=!0;try{let a;let s=window.appFabricInstance;if(null==(r=window.__shellInternal.segment)?void 0:r.analytics)t&&console.log("mc_ecs_logs: Appfabric Analytics library active. listening on events"),a=yield s.pubsub.subscribe("appfabric-analytics-api-event-data",t=>{var i;console.log("Host app received analytics data from appfabric-analytics-api-event-data topic",t);try{e.track(t),m({message:"ECS Tracking Library: AppFabric Initialize",data:{step:"SegmentInstance track fired"},keyIndex:"appfabric_init_track_fired"})}catch(e){w({message:"ECS Tracking Library: AppFabric Initialize",data:{step:"SegmentInstance track failed",appFabricInstance:typeof s,segmentAnalytics:typeof(null==(i=window.__shellInternal.segment)?void 0:i.analytics)},keyIndex:"appfabric_init"})}}),m({message:"ECS Tracking Library: AppFabric Initialize",data:{step:"apfInstance subscribe attempted",appFabricInstance:typeof s,segmentAnalytics:typeof(null==(o=window.__shellInternal.segment)?void 0:o.analytics)},keyIndex:"appfabric_init_track_attempted"});else{let e;t&&console.log("mc_ecs_logs: Appfabric Analytics library inActive. Launching initialize strategy");let i=0;do try{yield s.analytics.init(),i++,e=!1}catch(t){e=!0,w({message:"ECS Tracking Library: AppFabric Initialize",data:{step:"AppFabric failed to initialize"},keyIndex:"appfabric_init_failed_init"})}while(i<2&&e)}delete window.__shellInternal.segment.analytics,delete window.appFabricInstance.analytics,Object.defineProperty(window.__shellInternal.segment,"analytics",{value:e,writable:!1}),Object.defineProperty(window.appFabricInstance,"analytics",{value:e,writable:!1}),t&&console.log("mc_ecs_logs: Converted AppFabric Analytics to this library"),a&&(s.pubsub.unsubscribe(a),m({message:"ECS Tracking Library: AppFabric Initialize",data:{step:"AppFabric unsubscribe"},keyIndex:"appfabric_init_unsubscribe"})),i(!0),n.hasPromiseResolved=!0}catch(e){t&&(console.log("mc_ecs_logs: Error with connecting to Appfabric analytics"),console.error(e)),m({message:"ECS Tracking Library: AppFabric Initialize",data:{step:"AppFabric Error with connecting to Appfabric analytics"},keyIndex:"appfabric_init_error_connect"}),a(e),n.hasPromiseResolved=!0}}});window.AppFabric&&window.appFabricInstance?(t&&console.log("mc_ecs_logs: AppFabrics is initialized attempting to connect to it"),m({message:"ECS Tracking Library: AppFabric Initialize",data:{step:"connectAppFabricsAnalytics resolve"},keyIndex:"appfabric_init_resolve"}),r().then(i).catch(a)):(t&&console.log("mc_ecs_logs: Waiting for AppFabric Initialization Event"),P().addEventListener("abort",()=>{n.hasPromiseResolved||i(!1)}),m({message:"ECS Tracking Library: AppFabric Initialize",data:{step:"Listener with getAbortAppfabricInitialziedEventSignal"},keyIndex:"appfabric_init_listener"}),window.addEventListener(B,r,{signal:P()}))})}),G=e=>({payload:t,next:i})=>{switch(t.obj.type){case"track":if(t.obj.properties.event_sender_app_id){let i=d(d(d({},null==e?void 0:e.track),null==e?void 0:e.all),null==e?void 0:e.userSessionInfo);t.obj.context=d(d({initiative_name:"appfabric"},t.obj.context),i),t.obj.properties=d(d({initiative_name:"appfabric"},t.obj.properties),i)}break;case"identify":break;default:console.warn("unsupported event type: ",t.obj.type)}i(t)},R=["object","action","org","purpose","scope","initiative_name"],H=["object","action","org","purpose","scope"],q=({payload:e,next:t})=>{if("track"===e.obj.type){if(e.obj.properties["__mc-dynamic-eventing"]){for(let t of H)if(!e.obj.properties[t]){m({message:"Event Dropped",data:{eventObject:e.obj,fullContext:e,requiredProp:t},keyIndex:"dropped_event"}),console.warn("Dropping event because it doesn't contain the required property: ",t,e.obj);return}}else for(let t of R)if(!e.obj.properties[t]){m({message:"Event Dropped",data:{eventObject:e.obj,fullContext:e,requiredProp:t},keyIndex:"dropped_event"}),console.warn("Dropping event because it doesn't contain the required property: ",t,e.obj);return}}t(e)},U=["locale","page","userAgentData","userAgent"],W=e=>({payload:t,next:i})=>{if(!e){i(t);return}let a={};for(let i of[...R,...e])t.obj.context[i]&&(a[i]=t.obj.context[i]);let n=new Set(e);for(let e of(n.has("ip")||(a.ip="0.0.0.0"),U))n.has(e)||(a[e]=null);t.obj.context=a,i(t)},J=(e,t,i={})=>{if(null==t){if(m({message:"Track: Blocked Event",data:{eventObject:t,localOverrides:i},keyIndex:"blocked_event_emptyObject"}),e.isInDebugMode)throw Error("The 'eventObject' is required for sending events. Please refer to the ECS standard doc");console.trace(),console.warn("The 'eventObject' is required for sending events. Please refer to the ECS standard doc")}},K=(e,t,i="library")=>{if(void 0===t.object||void 0===t.action){m({message:"Track: Blocked Event",data:{eventObject:t,missingField:{object:void 0===t.object,action:void 0===t.action}},keyIndex:"blocked_event_missing_object_action"});let a="There is an issue with missing or incorrectly spelled action or object properties in your ECS event setup.";if("library"!==i&&(a="There is an issue with missing or incorrectly spelled action or object properties in your Authoring Tool tracking plan."),e.isInDebugMode)throw Error(a);console.trace(),console.error(a)}},V=(e,t,i,a={})=>{t[i]!==Symbol.for("__mc-ecs-storage")&&t[i]!==Symbol.for("__mc-dynamic-eventing")&&(m({message:"Track: Invalid Event",data:{eventObject:t,localOverrides:a,isDev:e.isInDebugMode},keyIndex:"invalid_event"}),e.isInDebugMode&&(console.trace(),console.warn(`The track event does not originate with '${i}'`),console.warn("Please reach out to the mc-ecs-event-help channel for support"),console.warn("Event: ",JSON.stringify(t,null,2))))},Z=(e,t,i={})=>{for(let a in i){if(void 0===t[a]){if(m({message:"Track: Blocked Event",data:{eventObject:t,localOverrides:i,invalidCustomProperties:!0},keyIndex:`blocked_event_${a}`}),e.isInDebugMode)throw Error(`Custom Properties can't be added to this event object: ${a}`);console.trace(),console.warn(`Custom Properties can't be added to this event object: ${a}`);return}if(void 0!==e.validator&&!e.validator.track(i[a])){if(m({message:"Track: Blocked Event",data:{eventObject:t,localOverrides:i,invalidProperty:!0},keyIndex:`blocked_event_${a}`}),e.isInDebugMode)throw Error(`The value: ${i[a]} provided to the property ${a} is invalid `);console.trace(),console.warn(`The value: ${i[a]} provided to the property ${a} is invalid `);return}}},X=(e,t,i={})=>{if(void 0!==e.validator){for(let a in t)if(!e.validator.track(t[a])){if(m({message:"Track: Blocked Event",data:{eventObject:t,localOverrides:i,invalidProperty:!0},keyIndex:`blocked_event_${a}`}),e.isInDebugMode)throw Error(`The value: ${t[a]} provided to the property ${a} is invalid `);console.trace(),console.warn(`The value: ${t[a]} provided to the property ${a} is invalid `);return}}},Y="object"==typeof window;if("function"==typeof importScripts)throw Error("This library cannot be used inside of a web worker");if(!Y)throw Error("This library can only be used on the web");let ee={userSessionInfo:{},isInDebugMode:!1,hasQueueFlushed:!1,track:{},identify:{},all:{},Segment:T},et={hasInitialized:!1,initialize:function(e,t,i){return u(this,arguments,function*(e,t,i,a={cancelAllListeners:!1,cancelAppfabricListeners:!1,loggerFunction:()=>{}}){var n;if(""===e||void 0===e)throw Error("Missing Write Key");if(E(a.loggerFunction),window.__MC_ECS_LIB.has_lib_init_started)return;for(let e in void 0!==a.validator&&(ee.validator=a.validator),D({internalState:ee,EcsTracking:et,LOGGER_STATE:b,BATCH_LOGS_INTERNAL_STATE:y}),window.__MC_ECS_LIB.has_lib_init_started=!0,M({internalState:ee,EcsTracking:et,LOGGER_STATE:b,BATCH_LOGS_INTERNAL_STATE:y}),i){let t=i[e];ee[e]=t}a.cancelAllListeners?L():a.cancelAppfabricListeners&&C();let r=p(d({},t),{user:{persist:!1}});if(void 0!==t.integrations&&(r.integrations=t.integrations),void 0!==t.user&&(r.user=d(d({},r.user),t.user)),void 0!==window.analytics&&(window.analytics.addSourceMiddleware(G(i)),window.analytics.addSourceMiddleware(q),window.analytics.addSourceMiddleware(W(null==i?void 0:i.allowList))),!et.hasInitialized){if(Array.isArray(window.analytics))for(let e of window.analytics)"track"===e[0]&&(e[2]=d(d(d(d({},e[2]),null==i?void 0:i.all),null==i?void 0:i.track),null==i?void 0:i.userSessionInfo),e[3]={context:d(d(d(d({},e[3].context),null==i?void 0:i.all),null==i?void 0:i.track),null==i?void 0:i.userSessionInfo)});try{yield T.init(e,r)}catch(e){m({message:"ECS Tracking Library: initialize function",data:{step:"The Analytics library failed to initialize: Ad blocker detected",hasLibraryInitialized:!1},keyIndex:"ad_blocker_detected"}),console.warn("The Analytics library failed to initialize. This is most likely due to an adblocker. If you're using an adblocker please disable it and try again"),et.hasInitialized=!1,L();return}if(et.hasInitialized=(null==(n=window.analytics)?void 0:n.initialize)!=null,et.hasInitialized){if(void 0!==window.analytics&&!a.cancelAllListeners&&!a.cancelAppfabricListeners){let e=setTimeout(()=>{C()},3e5);Q(window.analytics,ee.isInDebugMode).catch(e=>{w({message:"ECS Tracking Library: initialize function",data:{step:"Appfabric detection failed"}}),console.error(e)}).finally(()=>{clearTimeout(e),C()})}}else throw w({message:"ECS Tracking Library: initialize function",data:{step:"The Analytics library failed to initialize",hasLibraryInitialized:!1}}),Error("Analytics library failed to initialize. Please inspect the library initialization process")}})},track:function(e,t){if(null==e){if(m({message:"Track: Blocked Event",data:{eventObject:e,localOverrides:t},keyIndex:"blocked_event_emptyObject"}),ee.isInDebugMode)throw Error("The 'eventObject' is required for sending events. Please refer to the ECS standard doc");console.trace(),console.warn("The 'eventObject' is required for sending events. Please refer to the ECS standard doc");return}if(void 0===e.object||void 0===e.action){if(m({message:"Track: Blocked Event",data:{eventObject:e,missingField:{object:void 0===e.object,action:void 0===e.action}},keyIndex:"blocked_event_missing_object_action"}),ee.isInDebugMode)throw Error("The 'object' and 'action' property are required for sending events. Please refer to the ECS standard doc");console.trace(),console.warn("The 'object' and 'action' property are required for sending events. Please refer to the ECS standard doc");return}for(let i in e["__mc-ecs-storage"]!==Symbol.for("__mc-ecs-storage")&&(m({message:"Track: Invalid Event",data:{eventObject:e,localOverrides:t,isDev:ee.isInDebugMode},keyIndex:"invalid_event"}),ee.isInDebugMode&&(console.trace(),console.warn("The track event does not originate from the mc-ecs-storage"),console.warn("Please reach out to the mc-ecs-event-help channel for support"),console.warn("Event: ",JSON.stringify(e,null,2)))),t){if(void 0===e[i]){if(m({message:"Track: Blocked Event",data:{eventObject:e,localOverrides:t,invalidCustomProperties:!0},keyIndex:`blocked_event_${i}`}),ee.isInDebugMode)throw Error(`Custom Properties can't be added to this event object: ${i}`);console.trace(),console.warn(`Custom Properties can't be added to this event object: ${i}`);return}if(void 0!==ee.validator&&!ee.validator.track(t[i])){if(m({message:"Track: Blocked Event",data:{eventObject:e,localOverrides:t,invalidProperty:!0},keyIndex:`blocked_event_${i}`}),ee.isInDebugMode)throw Error(`The value: ${t[i]} provided to the property ${i} is invalid `);console.trace(),console.warn(`The value: ${t[i]} provided to the property ${i} is invalid `);return}}if(void 0!==ee.validator){for(let i in e)if(!ee.validator.track(e[i])){if(m({message:"Track: Blocked Event",data:{eventObject:e,localOverrides:t,invalidProperty:!0},keyIndex:`blocked_event_${i}`}),ee.isInDebugMode)throw Error(`The value: ${e[i]} provided to the property ${i} is invalid `);console.trace(),console.warn(`The value: ${e[i]} provided to the property ${i} is invalid `);return}}if(S(T.Analytics)){let i=d(d(d({},e),t),ee.userSessionInfo),a={context:d(d(d({},ee.all),ee.track),ee.userSessionInfo)};ee.Segment.Analytics.track(`${i.object}:${i.action}`,i,a)}},identify:function(e,t){if(""===e)throw Error("A user id will need to be provided when using this function");if(ee.__userId=e,S(T.Analytics)){ee.userSessionInfo=d({user_id:e},t);let i={context:d(d(d({},ee.all),ee.identify),ee.userSessionInfo)};ee.Segment.Analytics.identify(e,t,i)}},debug:function(){if(!ee.isInDebugMode&&(console.warn("DEBUGGER INITIALIZED"),ee.isInDebugMode=!0,S(T.Analytics)))for(let e of(ee.Segment.Analytics.debug(!0),["initialize","call_after_close","screen","identify","group","track","ready","alias","page","error","register","deregister"]))ee.Segment.Analytics.on(e,(e,t,i)=>{console.warn("Current Event: ",e),console.warn("Properties",t),console.warn("Options",i)})},dynamicTrack:function(e,t,a){return u(this,null,function*(){let n=new(yield i.e("98568").then(i.bind(i,542205)).then(e=>e.i)).BaseEventing({eventHandler:()=>{},errorHandler:i=>{"Dynamic_Eventing_Validation_Error"!==i&&(w({message:"ECS Dynamic Web Eventing Error",data:{event_data:i,config_url:e,dynamic_id:t,event_properties:a}}),ee.isInDebugMode&&console.error("Authoring Tool Error: "+i+"\nDynamic ID: "+t+"\nConfig URL: "+e))},sourceData:{url:e,fallbackData:{},backupUrl:""}});V(ee,a,"__mc-dynamic-eventing");let r=n.handleEvent(t,{},{}),o=yield r;if(S(T.Analytics)){let e=d(d(d({},o),a),ee.userSessionInfo),t={context:d(d(d({},ee.all),ee.track),ee.userSessionInfo)};Object.defineProperty(e,"__mc-dynamic-eventing",{value:Symbol.for("__mc-dynamic-eventing"),enumerable:!1,writable:!1,configurable:!1}),J(ee,e),K(ee,e,"authoring-tool"),Z(ee,e),X(ee,e),(!(null==e?void 0:e.screen)||(null==e?void 0:e.screen)==="<auto-populated>")&&(null==e?void 0:e.dynamic_screen)&&(e.screen=e.dynamic_screen),ee.Segment.Analytics.track(`${e.object}:${e.action}`,e,t)}})}},ei=window.__MC_ECS_LIB?window.__MC_ECS_LIB.has_lib_init_started:(N(),!1);T.attachAnalyticsToWindow(),(({internalState:e,EcsTracking:t,LOGGER_STATE:i,BATCH_LOGS_INTERNAL_STATE:a})=>{let n=!1;window.addEventListener(x,i=>{!n&&e!==i.detail.internalState&&(n=!0,Object.keys(i.detail.internalState).forEach(t=>{let a=i.detail.internalState[t];e[t]=a}),Object.keys(i.detail.EcsTracking).forEach(e=>{let a=i.detail.EcsTracking[e];t[e]=a}),i.detail.LOGGER_STATE.hasInitialized&&Array.isArray(a.mainQueue)&&a.mainQueue.forEach(e=>{i.detail.BATCH_LOGS_INTERNAL_STATE&&i.detail.BATCH_LOGS_INTERNAL_STATE.mainQueue&&Array.isArray(i.detail.BATCH_LOGS_INTERNAL_STATE.mainQueue)&&i.detail.BATCH_LOGS_INTERNAL_STATE.mainQueue.push(e)}),i.detail.LOGGER_STATE,i.detail.BATCH_LOGS_INTERNAL_STATE&&(a=i.detail.BATCH_LOGS_INTERNAL_STATE)),n&&j()},{signal:z()})})({internalState:ee,EcsTracking:et,LOGGER_STATE:b,BATCH_LOGS_INTERNAL_STATE:y}),ei&&window.dispatchEvent(new Event(O,{cancelable:!1}))}}]);
//# sourceMappingURL=14890.6b855c485fd0c8cd.js.map